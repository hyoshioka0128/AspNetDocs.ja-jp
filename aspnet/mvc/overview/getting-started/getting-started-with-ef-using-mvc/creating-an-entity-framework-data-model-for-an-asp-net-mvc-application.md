---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application
title: 'チュートリアル: Entity Framework 6 Code First MVC 5 の使用の概要 |Microsoft Docs'
description: このチュートリアル シリーズでは、データ アクセスに Entity Framework 6 を使用する ASP.NET MVC 5 アプリケーションを構築する方法について説明します。
author: tdykstra
ms.author: riande
ms.date: 01/22/2019
ms.topic: tutorial
ms.assetid: 00bc8b51-32ed-4fd3-9745-be4c2a9c1eaf
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application
msc.type: authoredcontent
ms.openlocfilehash: a00a5a3aa295c2584b90abbf931c258c9e1b58ca
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/01/2019
ms.locfileid: "57057969"
---
# <a name="tutorial-get-started-with-entity-framework-6-code-first-using-mvc-5"></a><span data-ttu-id="642cd-103">チュートリアル: Entity Framework 6 Code First MVC 5 の使用の概要します。</span><span class="sxs-lookup"><span data-stu-id="642cd-103">Tutorial: Get Started with Entity Framework 6 Code First using MVC 5</span></span>

> [!NOTE]
> <span data-ttu-id="642cd-104">新しい開発の場合はお勧めします[ASP.NET Core Razor ページ](/aspnet/core/razor-pages)ASP.NET MVC コント ローラーとビューを経由します。</span><span class="sxs-lookup"><span data-stu-id="642cd-104">For new development, we recommend [ASP.NET Core Razor Pages](/aspnet/core/razor-pages) over ASP.NET MVC controllers and views.</span></span> <span data-ttu-id="642cd-105">このようなチュートリアルのシリーズの Razor ページを使用して、参照してください[チュートリアル。ASP.NET Core で Razor ページの概要](/aspnet/core/tutorials/razor-pages/razor-pages-start)します。</span><span class="sxs-lookup"><span data-stu-id="642cd-105">For a tutorial series similar to this one using Razor Pages, see [Tutorial: Get started with Razor Pages in ASP.NET Core](/aspnet/core/tutorials/razor-pages/razor-pages-start).</span></span> <span data-ttu-id="642cd-106">新しいチュートリアル:</span><span class="sxs-lookup"><span data-stu-id="642cd-106">The new tutorial:</span></span>
> * <span data-ttu-id="642cd-107">理解しやすい。</span><span class="sxs-lookup"><span data-stu-id="642cd-107">Is easier to follow.</span></span>
> * <span data-ttu-id="642cd-108">より多くの EF Core のベスト プラクティスが提供されている。</span><span class="sxs-lookup"><span data-stu-id="642cd-108">Provides more EF Core best practices.</span></span>
> * <span data-ttu-id="642cd-109">より効率的なクエリを使用している。</span><span class="sxs-lookup"><span data-stu-id="642cd-109">Uses more efficient queries.</span></span>
> * <span data-ttu-id="642cd-110">より最新の API を使用している。</span><span class="sxs-lookup"><span data-stu-id="642cd-110">Is more current with the latest API.</span></span>
> * <span data-ttu-id="642cd-111">多くの機能をカバーしている。</span><span class="sxs-lookup"><span data-stu-id="642cd-111">Covers more features.</span></span>
> * <span data-ttu-id="642cd-112">新しいアプリケーションの開発で推奨されるアプローチである。</span><span class="sxs-lookup"><span data-stu-id="642cd-112">Is the preferred approach for new application development.</span></span>

<span data-ttu-id="642cd-113">このチュートリアル シリーズでは、データ アクセスに Entity Framework 6 を使用する ASP.NET MVC 5 アプリケーションを構築する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="642cd-113">In this series of tutorials, you learn how to build an ASP.NET MVC 5 application that uses Entity Framework 6 for data access.</span></span> <span data-ttu-id="642cd-114">このチュートリアルでは、Code First ワークフローを使用します。</span><span class="sxs-lookup"><span data-stu-id="642cd-114">This tutorial uses the Code First workflow.</span></span> <span data-ttu-id="642cd-115">Code First、Database First または Model First を選択する方法については、[モデルを作成する](/ef/ef6/modeling/)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-115">For information about how to choose between Code First, Database First, and Model First, see [Create a model](/ef/ef6/modeling/).</span></span>

<span data-ttu-id="642cd-116">このチュートリアル シリーズでは、Contoso University のサンプル アプリケーションを構築する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="642cd-116">This tutorial series explains how to build the Contoso University sample application.</span></span> <span data-ttu-id="642cd-117">サンプル アプリケーションは、簡単な大学向け web サイトです。</span><span class="sxs-lookup"><span data-stu-id="642cd-117">The sample application is a simple university website.</span></span> <span data-ttu-id="642cd-118">それには表示して学生、コース、およびインストラクターの情報を更新します。</span><span class="sxs-lookup"><span data-stu-id="642cd-118">With it, you can view and update student, course, and instructor information.</span></span> <span data-ttu-id="642cd-119">作成する画面の 2 つを次に示します。</span><span class="sxs-lookup"><span data-stu-id="642cd-119">Here are two of the screens you create:</span></span>

![Students_Index_page](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/image1.png)

![学生を編集します。](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/image2.png)

<span data-ttu-id="642cd-122">このチュートリアルでは、次の作業を行いました。</span><span class="sxs-lookup"><span data-stu-id="642cd-122">In this tutorial, you:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="642cd-123">MVC web アプリを作成します。</span><span class="sxs-lookup"><span data-stu-id="642cd-123">Create an MVC web app</span></span>
> * <span data-ttu-id="642cd-124">サイトのスタイルを設定する</span><span class="sxs-lookup"><span data-stu-id="642cd-124">Set up the site style</span></span>
> * <span data-ttu-id="642cd-125">Entity Framework 6 をインストールします。</span><span class="sxs-lookup"><span data-stu-id="642cd-125">Install Entity Framework 6</span></span>
> * <span data-ttu-id="642cd-126">データ モデルを作成する</span><span class="sxs-lookup"><span data-stu-id="642cd-126">Create the data model</span></span>
> * <span data-ttu-id="642cd-127">データベース コンテキストの作成</span><span class="sxs-lookup"><span data-stu-id="642cd-127">Create the database context</span></span>
> * <span data-ttu-id="642cd-128">テスト データで DB を初期化する</span><span class="sxs-lookup"><span data-stu-id="642cd-128">Initialize DB with test data</span></span>
> * <span data-ttu-id="642cd-129">LocalDB を使用するよう EF 6 に設定します。</span><span class="sxs-lookup"><span data-stu-id="642cd-129">Set up EF 6 to use LocalDB</span></span>
> * <span data-ttu-id="642cd-130">コントローラーとビューを作成する</span><span class="sxs-lookup"><span data-stu-id="642cd-130">Create controller and views</span></span>
> * <span data-ttu-id="642cd-131">データベースを表示する</span><span class="sxs-lookup"><span data-stu-id="642cd-131">View the database</span></span>

## <a name="prerequisites"></a><span data-ttu-id="642cd-132">必須コンポーネント</span><span class="sxs-lookup"><span data-stu-id="642cd-132">Prerequisites</span></span>

* [<span data-ttu-id="642cd-133">Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="642cd-133">Visual Studio 2017</span></span>](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=button+cta&utm_content=download+vs2017)

## <a name="create-an-mvc-web-app"></a><span data-ttu-id="642cd-134">MVC web アプリを作成します。</span><span class="sxs-lookup"><span data-stu-id="642cd-134">Create an MVC web app</span></span>

1. <span data-ttu-id="642cd-135">Visual Studio を開き、作成、 C# web プロジェクトを使用して、 **ASP.NET Web アプリケーション (.NET Framework)** テンプレート。</span><span class="sxs-lookup"><span data-stu-id="642cd-135">Open Visual Studio and create a C# web project using the **ASP.NET Web Application (.NET Framework)** template.</span></span> <span data-ttu-id="642cd-136">プロジェクトに名前を*ContosoUniversity*選択**OK**。</span><span class="sxs-lookup"><span data-stu-id="642cd-136">Name the project *ContosoUniversity* and select **OK**.</span></span>

   ![Visual Studio で新しいプロジェクト ダイアログ ボックス](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/new-project-dialog.png)

1. <span data-ttu-id="642cd-138">**新しい ASP.NET Web アプリケーション - ContosoUniversity**、 **MVC**します。</span><span class="sxs-lookup"><span data-stu-id="642cd-138">In **New ASP.NET Web Application - ContosoUniversity**, select **MVC**.</span></span>

   ![Visual Studio での新しい web アプリ ダイアログ ボックス](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/new-web-app-dialog.png)

    > [!NOTE]
    > <span data-ttu-id="642cd-140">既定で、**認証**にオプションが設定されている**認証なし**します。</span><span class="sxs-lookup"><span data-stu-id="642cd-140">By default, the **Authentication** option is set to **No Authentication**.</span></span> <span data-ttu-id="642cd-141">このチュートリアルでは、web アプリにサインインするユーザーを必要としません。</span><span class="sxs-lookup"><span data-stu-id="642cd-141">For this tutorial, the web app doesn't require users to sign in.</span></span> <span data-ttu-id="642cd-142">また、これサインインしているユーザーに基づくアクセスは制限されません。</span><span class="sxs-lookup"><span data-stu-id="642cd-142">Also, it doesn't restrict access based on who's signed in.</span></span>

1. <span data-ttu-id="642cd-143">**[OK]** をクリックして、プロジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="642cd-143">Select **OK** to create the project.</span></span>

## <a name="set-up-the-site-style"></a><span data-ttu-id="642cd-144">サイトのスタイルを設定する</span><span class="sxs-lookup"><span data-stu-id="642cd-144">Set up the site style</span></span>

<span data-ttu-id="642cd-145">簡単な変更をいくつか行い、サイトのメニュー、レイアウト、ホーム ページを決めます。</span><span class="sxs-lookup"><span data-stu-id="642cd-145">A few simple changes will set up the site menu, layout, and home page.</span></span>

1. <span data-ttu-id="642cd-146">開いている*views \shared\\_Layout.cshtml*、次の変更を行います。</span><span class="sxs-lookup"><span data-stu-id="642cd-146">Open *Views\Shared\\_Layout.cshtml*, and make the following changes:</span></span>

   - <span data-ttu-id="642cd-147">各出現する"My ASP.NET Application"、"Application name"を"Contoso University"に変更します。</span><span class="sxs-lookup"><span data-stu-id="642cd-147">Change each occurrence of "My ASP.NET Application" and "Application name" to "Contoso University".</span></span>
   - <span data-ttu-id="642cd-148">学生、コース、教員、および部門、メニュー エントリを追加し、連絡先エントリを削除します。</span><span class="sxs-lookup"><span data-stu-id="642cd-148">Add menu entries for Students, Courses, Instructors, and Departments, and delete the Contact entry.</span></span>

   <span data-ttu-id="642cd-149">次のコード スニペットでは、変更が強調表示されます。</span><span class="sxs-lookup"><span data-stu-id="642cd-149">The changes are highlighted in the following code snippet:</span></span>

   [!code-cshtml[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample1.cshtml?highlight=6,19,24-27,38)]

2. <span data-ttu-id="642cd-150">*Views\Home\Index.cshtml*ファイルの内容を ASP.NET と MVC に関するテキストをこのアプリケーションに関するテキストに置き換えるには、次のコードに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="642cd-150">In *Views\Home\Index.cshtml*, replace the contents of the file with the following code to replace the text about ASP.NET and MVC with text about this application:</span></span>

   [!code-cshtml[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample2.cshtml)]

3. <span data-ttu-id="642cd-151">Web サイトを実行するには、Ctrl + F5 キーを押します。</span><span class="sxs-lookup"><span data-stu-id="642cd-151">Press Ctrl+F5 to run the web site.</span></span> <span data-ttu-id="642cd-152">メイン メニューで、ホーム ページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-152">You see the home page with the main menu.</span></span>

## <a name="install-entity-framework-6"></a><span data-ttu-id="642cd-153">Entity Framework 6 をインストールします。</span><span class="sxs-lookup"><span data-stu-id="642cd-153">Install Entity Framework 6</span></span>

1. <span data-ttu-id="642cd-154">**ツール**] メニューの [選択**NuGet パッケージ マネージャー**を選び、**パッケージ マネージャー コンソール**します。</span><span class="sxs-lookup"><span data-stu-id="642cd-154">From the **Tools** menu, choose **NuGet Package Manager**, and then choose **Package Manager Console**.</span></span>

2. <span data-ttu-id="642cd-155">**パッケージ マネージャー コンソール**ウィンドウで、次のコマンドを入力します。</span><span class="sxs-lookup"><span data-stu-id="642cd-155">In the **Package Manager Console** window, enter the following command:</span></span>

   ```text
   Install-Package EntityFramework
   ```

<span data-ttu-id="642cd-156">この手順は、このチュートリアルでは、手動で行うことがいる可能性がありますが完了に自動的に ASP.NET MVC のスキャフォールディング機能によって、いくつかの手順のいずれかです。</span><span class="sxs-lookup"><span data-stu-id="642cd-156">This step is one of a few steps that this tutorial has you do manually, but that could have been done automatically by the ASP.NET MVC scaffolding feature.</span></span> <span data-ttu-id="642cd-157">Entity Framework (EF) を使用するために必要な手順が表示されるため、それらを手動で行ってしています。</span><span class="sxs-lookup"><span data-stu-id="642cd-157">You're doing them manually so that you can see the steps required to use Entity Framework (EF).</span></span> <span data-ttu-id="642cd-158">MVC コント ローラーとビューを作成して後でスキャフォールディングを使用します。</span><span class="sxs-lookup"><span data-stu-id="642cd-158">You'll use scaffolding later to create the MVC controller and views.</span></span> <span data-ttu-id="642cd-159">別の方法はスキャフォールディングを自動的に EF の NuGet パッケージをインストール、データベース コンテキスト クラスを作成および接続文字列を作成します。</span><span class="sxs-lookup"><span data-stu-id="642cd-159">An alternative is to let scaffolding automatically install the EF NuGet package, create the database context class, and create the connection string.</span></span> <span data-ttu-id="642cd-160">方法で実行する準備ができたら、行う必要があるすべてがこれらの手順をスキップし、エンティティ クラスを作成した後に、MVC コント ローラーをスキャフォールディングします。</span><span class="sxs-lookup"><span data-stu-id="642cd-160">When you're ready to do it that way, all you have to do is skip those steps and scaffold your MVC controller after you create your entity classes.</span></span>

## <a name="create-the-data-model"></a><span data-ttu-id="642cd-161">データ モデルを作成する</span><span class="sxs-lookup"><span data-stu-id="642cd-161">Create the data model</span></span>

<span data-ttu-id="642cd-162">次に、Contoso University アプリケーションのエンティティ クラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="642cd-162">Next you'll create entity classes for the Contoso University application.</span></span> <span data-ttu-id="642cd-163">次の 3 つのエンティティをから始めます。</span><span class="sxs-lookup"><span data-stu-id="642cd-163">You'll start with the following three entities:</span></span>

<span data-ttu-id="642cd-164">**コース** <-> **登録** <-> **学生**</span><span class="sxs-lookup"><span data-stu-id="642cd-164">**Course** <-> **Enrollment** <-> **Student**</span></span>

| <span data-ttu-id="642cd-165">エンティティ</span><span class="sxs-lookup"><span data-stu-id="642cd-165">Entities</span></span> | <span data-ttu-id="642cd-166">Relationship</span><span class="sxs-lookup"><span data-stu-id="642cd-166">Relationship</span></span> |
| -------- | ------------ |
| <span data-ttu-id="642cd-167">コースの登録を</span><span class="sxs-lookup"><span data-stu-id="642cd-167">Course to Enrollment</span></span> | <span data-ttu-id="642cd-168">一対多</span><span class="sxs-lookup"><span data-stu-id="642cd-168">One-to-many</span></span> |
| <span data-ttu-id="642cd-169">学生を登録する</span><span class="sxs-lookup"><span data-stu-id="642cd-169">Student to Enrollment</span></span> | <span data-ttu-id="642cd-170">一対多</span><span class="sxs-lookup"><span data-stu-id="642cd-170">One-to-many</span></span> |

<span data-ttu-id="642cd-171">`Student` エンティティと `Enrollment` エンティティの間に一対多の関係があり、`Course` エンティティと `Enrollment` エンティティの間に一対多の関係があります。</span><span class="sxs-lookup"><span data-stu-id="642cd-171">There's a one-to-many relationship between `Student` and `Enrollment` entities, and there's a one-to-many relationship between `Course` and `Enrollment` entities.</span></span> <span data-ttu-id="642cd-172">言い換えると、1 人の学生をさまざまな講座に登録し、1 つの講座にたくさんの学生を登録できます。</span><span class="sxs-lookup"><span data-stu-id="642cd-172">In other words, a student can be enrolled in any number of courses, and a course can have any number of students enrolled in it.</span></span>

<span data-ttu-id="642cd-173">次のセクションでは、これらのエンティティのそれぞれのクラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="642cd-173">In the following sections, you'll create a class for each one of these entities.</span></span>

> [!NOTE]
> <span data-ttu-id="642cd-174">これらのエンティティ クラスのすべての作成を完了する前に、プロジェクトをコンパイルしようとすると、コンパイラ エラーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="642cd-174">If you try to compile the project before you finish creating all of these entity classes, you'll get compiler errors.</span></span>

### <a name="the-student-entity"></a><span data-ttu-id="642cd-175">Student エンティティ</span><span class="sxs-lookup"><span data-stu-id="642cd-175">The Student entity</span></span>

- <span data-ttu-id="642cd-176">*モデル*フォルダー、という名前のクラス ファイルを作成する*Student.cs*でフォルダーを右クリックして**ソリューション エクスプ ローラー**を選択して**追加**  > **クラス**します。</span><span class="sxs-lookup"><span data-stu-id="642cd-176">In the *Models* folder, create a class file named *Student.cs* by right-clicking on the folder in **Solution Explorer** and choosing **Add** > **Class**.</span></span> <span data-ttu-id="642cd-177">テンプレート コードを次のコードに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="642cd-177">Replace the template code with the following code:</span></span>

   [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample3.cs)]

<span data-ttu-id="642cd-178">`ID` プロパティは、このクラスに相当するデータベース テーブルの主キー列になります。</span><span class="sxs-lookup"><span data-stu-id="642cd-178">The `ID` property will become the primary key column of the database table that corresponds to this class.</span></span> <span data-ttu-id="642cd-179">既定では、Entity Framework がという名前のプロパティを解釈`ID`または*classname* `ID`主キーとして。</span><span class="sxs-lookup"><span data-stu-id="642cd-179">By default, Entity Framework interprets a property that's named `ID` or *classname* `ID` as the primary key.</span></span>

<span data-ttu-id="642cd-180">`Enrollments` プロパティは*ナビゲーション プロパティ*です。</span><span class="sxs-lookup"><span data-stu-id="642cd-180">The `Enrollments` property is a *navigation property*.</span></span> <span data-ttu-id="642cd-181">ナビゲーション プロパティには、このエンティティに関連する他のエンティティが含まれます。</span><span class="sxs-lookup"><span data-stu-id="642cd-181">Navigation properties hold other entities that are related to this entity.</span></span> <span data-ttu-id="642cd-182">ここで、`Enrollments`のプロパティを`Student`すべてのエンティティを保持、`Enrollment`に関連付けられているエンティティ`Student`エンティティ。</span><span class="sxs-lookup"><span data-stu-id="642cd-182">In this case, the `Enrollments` property of a `Student` entity will hold all of the `Enrollment` entities that are related to that `Student` entity.</span></span> <span data-ttu-id="642cd-183">つまり場合、指定された`Student`データベース内の行が 2 つの関連`Enrollment`行 (その学生の主キーを含む行の値で、`StudentID`外部キー列)、その`Student`エンティティの`Enrollments`ナビゲーション プロパティこれら 2 つが含まれます`Enrollment`エンティティ。</span><span class="sxs-lookup"><span data-stu-id="642cd-183">In other words, if a given `Student` row in the database has two related `Enrollment` rows (rows that contain that student's primary key value in their `StudentID` foreign key column), that `Student` entity's `Enrollments` navigation property will contain those two `Enrollment` entities.</span></span>

<span data-ttu-id="642cd-184">ナビゲーション プロパティは、通常、として定義`virtual`などの特定の Entity Framework の機能を利用を行うことができるように*遅延読み込み*します。</span><span class="sxs-lookup"><span data-stu-id="642cd-184">Navigation properties are typically defined as `virtual` so that they can take advantage of certain Entity Framework functionality such as *lazy loading*.</span></span> <span data-ttu-id="642cd-185">(遅延読み込みについては説明後の「、[関連データの読み取り](reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-application.md)このシリーズの後半のチュートリアルです)。</span><span class="sxs-lookup"><span data-stu-id="642cd-185">(Lazy loading will be explained later, in the [Reading Related Data](reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-application.md) tutorial later in this series.)</span></span>

<span data-ttu-id="642cd-186">ナビゲーション プロパティに複数のエンティティが含まれる場合 (多対多または一対多の関係で)、その型はリストにする必要があります。`ICollection` のように、エンティティを追加、削除、更新できるリストです。</span><span class="sxs-lookup"><span data-stu-id="642cd-186">If a navigation property can hold multiple entities (as in many-to-many or one-to-many relationships), its type must be a list in which entries can be added, deleted, and updated, such as `ICollection`.</span></span>

### <a name="the-enrollment-entity"></a><span data-ttu-id="642cd-187">Enrollment エンティティ</span><span class="sxs-lookup"><span data-stu-id="642cd-187">The Enrollment entity</span></span>

- <span data-ttu-id="642cd-188">*[Models]* フォルダーで、*Enrollment.cs* を作成し、既存のコードを次のコードに変更します。</span><span class="sxs-lookup"><span data-stu-id="642cd-188">In the *Models* folder, create *Enrollment.cs* and replace the existing code with the following code:</span></span>

   [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample4.cs)]

<span data-ttu-id="642cd-189">`EnrollmentID`プロパティは、主キーになります。 このエンティティを使用して、 *classname* `ID`の代わりにパターン`ID`を単独で使用した、`Student`エンティティ。</span><span class="sxs-lookup"><span data-stu-id="642cd-189">The `EnrollmentID` property will be the primary key; this entity uses the *classname* `ID` pattern instead of `ID` by itself as you saw in the `Student` entity.</span></span> <span data-ttu-id="642cd-190">通常、パターンを 1 つ選択し、データ モデル全体でそれを使用します。</span><span class="sxs-lookup"><span data-stu-id="642cd-190">Ordinarily you would choose one pattern and use it throughout your data model.</span></span> <span data-ttu-id="642cd-191">ここのバリエーションから、いずれのパターンも利用できることがわかります。</span><span class="sxs-lookup"><span data-stu-id="642cd-191">Here, the variation illustrates that you can use either pattern.</span></span> <span data-ttu-id="642cd-192">後のチュートリアルで紹介を使用する方法`ID`せず`classname`データ モデルで継承を実装しやすきます。</span><span class="sxs-lookup"><span data-stu-id="642cd-192">In a later tutorial, you'll see how using `ID` without `classname` makes it easier to implement inheritance in the data model.</span></span>

<span data-ttu-id="642cd-193">`Grade`プロパティは、 [enum](/ef/ef6/modeling/code-first/data-types/enums)します。</span><span class="sxs-lookup"><span data-stu-id="642cd-193">The `Grade` property is an [enum](/ef/ef6/modeling/code-first/data-types/enums).</span></span> <span data-ttu-id="642cd-194">後の疑問符、`Grade`型宣言では、ことを示します、`Grade`プロパティは[null 許容](/dotnet/csharp/programming-guide/nullable-types/using-nullable-types)します。</span><span class="sxs-lookup"><span data-stu-id="642cd-194">The question mark after the `Grade` type declaration indicates that the `Grade` property is [nullable](/dotnet/csharp/programming-guide/nullable-types/using-nullable-types).</span></span> <span data-ttu-id="642cd-195">Null であるグレードが 0 の点から異なる-null は、評価が不明なまたはまだ割り当てられていないことを意味します。</span><span class="sxs-lookup"><span data-stu-id="642cd-195">A grade that's null is different from a zero grade — null means a grade isn't known or hasn't been assigned yet.</span></span>

<span data-ttu-id="642cd-196">`StudentID` プロパティは外部キーです。それに対応するナビゲーション プロパティは `Student` です。</span><span class="sxs-lookup"><span data-stu-id="642cd-196">The `StudentID` property is a foreign key, and the corresponding navigation property is `Student`.</span></span> <span data-ttu-id="642cd-197">`Enrollment` エンティティは 1 つの `Student` エンティティに関連付けられており、1 つの `Student` エンティティだけを保持できます (先に見た、複数の `Enrollment` エンティティを保持できる `Student.Enrollments` ナビゲーション プロパティとは異なります)。</span><span class="sxs-lookup"><span data-stu-id="642cd-197">An `Enrollment` entity is associated with one `Student` entity, so the property can only hold a single `Student` entity (unlike the `Student.Enrollments` navigation property you saw earlier, which can hold multiple `Enrollment` entities).</span></span>

<span data-ttu-id="642cd-198">`CourseID` プロパティは外部キーです。それに対応するナビゲーション プロパティは `Course` です。</span><span class="sxs-lookup"><span data-stu-id="642cd-198">The `CourseID` property is a foreign key, and the corresponding navigation property is `Course`.</span></span> <span data-ttu-id="642cd-199">`Enrollment` エンティティは 1 つの `Course` エンティティに関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="642cd-199">An `Enrollment` entity is associated with one `Course` entity.</span></span>

<span data-ttu-id="642cd-200">Entity Framework がという名前が場合に、外部キー プロパティとしてプロパティを解釈 *&lt;ナビゲーション プロパティの名前&gt;&lt;主キー プロパティ名&gt;* (たとえば、 `StudentID`の`Student`からナビゲーション プロパティ、`Student`エンティティの主キーが`ID`)。</span><span class="sxs-lookup"><span data-stu-id="642cd-200">Entity Framework interprets a property as a foreign key property if it's named *&lt;navigation property name&gt;&lt;primary key property name&gt;* (for example, `StudentID` for the `Student` navigation property since the `Student` entity's primary key is `ID`).</span></span> <span data-ttu-id="642cd-201">外部キー プロパティできますも同じ名前に単に *&lt;主キー プロパティ名&gt;* (たとえば、`CourseID`ので、`Course`エンティティの主キーが`CourseID`)。</span><span class="sxs-lookup"><span data-stu-id="642cd-201">Foreign key properties can also be named the same simply *&lt;primary key property name&gt;* (for example, `CourseID` since the `Course` entity's primary key is `CourseID`).</span></span>

### <a name="the-course-entity"></a><span data-ttu-id="642cd-202">Course エンティティ</span><span class="sxs-lookup"><span data-stu-id="642cd-202">The Course entity</span></span>

- <span data-ttu-id="642cd-203">*モデル*フォルダー作成*Course.cs*、テンプレート コードを次のコードに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="642cd-203">In the *Models* folder, create *Course.cs*, replacing the template code with the following code:</span></span>

   [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample5.cs)]

<span data-ttu-id="642cd-204">`Enrollments` プロパティはナビゲーション プロパティです。</span><span class="sxs-lookup"><span data-stu-id="642cd-204">The `Enrollments` property is a navigation property.</span></span> <span data-ttu-id="642cd-205">1 つの `Course` エンティティにたくさんの `Enrollment` エンティティを関連付けることができます。</span><span class="sxs-lookup"><span data-stu-id="642cd-205">A `Course` entity can be related to any number of `Enrollment` entities.</span></span>

<span data-ttu-id="642cd-206">ここでの詳細について、<xref:System.ComponentModel.DataAnnotations.Schema.DatabaseGeneratedAttribute>このシリーズの以降のチュートリアルでは属性。</span><span class="sxs-lookup"><span data-stu-id="642cd-206">We'll say more about the <xref:System.ComponentModel.DataAnnotations.Schema.DatabaseGeneratedAttribute> attribute in a later tutorial in this series.</span></span> <span data-ttu-id="642cd-207">基本的に、この属性によって、講座の主キーをデータベースに生成させず、自分で入力できるようになります。</span><span class="sxs-lookup"><span data-stu-id="642cd-207">Basically, this attribute lets you enter the primary key for the course rather than having the database generate it.</span></span>

## <a name="create-the-database-context"></a><span data-ttu-id="642cd-208">データベース コンテキストの作成</span><span class="sxs-lookup"><span data-stu-id="642cd-208">Create the database context</span></span>

<span data-ttu-id="642cd-209">指定されたデータ モデルの Entity Framework の機能を調整するメイン クラスは、*データベース コンテキスト*クラス。</span><span class="sxs-lookup"><span data-stu-id="642cd-209">The main class that coordinates Entity Framework functionality for a given data model is the *database context* class.</span></span> <span data-ttu-id="642cd-210">派生することによってこのクラスを作成する、 [System.Data.Entity.DbContext](https://msdn.microsoft.com/library/system.data.entity.dbcontext(v=vs.113).aspx)クラス。</span><span class="sxs-lookup"><span data-stu-id="642cd-210">You create this class by deriving from the [System.Data.Entity.DbContext](https://msdn.microsoft.com/library/system.data.entity.dbcontext(v=vs.113).aspx) class.</span></span> <span data-ttu-id="642cd-211">コードでは、データ モデルのエンティティが含まれているを指定します。</span><span class="sxs-lookup"><span data-stu-id="642cd-211">In your code, you specify which entities are included in the data model.</span></span> <span data-ttu-id="642cd-212">Entity Framework の特定の動作をカスタマイズすることもできます。</span><span class="sxs-lookup"><span data-stu-id="642cd-212">You can also customize certain Entity Framework behavior.</span></span> <span data-ttu-id="642cd-213">このプロジェクトでは、クラスに `SchoolContext` という名前が付けられています。</span><span class="sxs-lookup"><span data-stu-id="642cd-213">In this project, the class is named `SchoolContext`.</span></span>

- <span data-ttu-id="642cd-214">ContosoUniversity プロジェクトのフォルダーを作成するでプロジェクトを右クリックして**ソリューション エクスプ ローラー**クリック**追加**、順にクリックします**新しいフォルダー**します。</span><span class="sxs-lookup"><span data-stu-id="642cd-214">To create a folder in the ContosoUniversity project, right-click the project in **Solution Explorer** and click **Add**, and then click **New Folder**.</span></span> <span data-ttu-id="642cd-215">新しいフォルダーの名前*DAL* (のデータ アクセス層)。</span><span class="sxs-lookup"><span data-stu-id="642cd-215">Name the new folder *DAL* (for Data Access Layer).</span></span> <span data-ttu-id="642cd-216">という名前の新しいクラス ファイルを作成すると、そのフォルダー内*SchoolContext.cs*、テンプレート コードを次のコードに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="642cd-216">In that folder, create a new class file named *SchoolContext.cs*, and replace the template code with the following code:</span></span>

   [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample6.cs)]

### <a name="specify-entity-sets"></a><span data-ttu-id="642cd-217">エンティティ セットを指定します。</span><span class="sxs-lookup"><span data-stu-id="642cd-217">Specify entity sets</span></span>

<span data-ttu-id="642cd-218">このコードを作成、 [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.113).aspx)各エンティティ セットのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="642cd-218">This code creates a [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.113).aspx) property for each entity set.</span></span> <span data-ttu-id="642cd-219">Entity Framework の用語で、*エンティティ セット*通常、データベース テーブルに対応し、*エンティティ*テーブルの行に対応しています。</span><span class="sxs-lookup"><span data-stu-id="642cd-219">In Entity Framework terminology, an *entity set* typically corresponds to a database table, and an *entity* corresponds to a row in the table.</span></span>

> [!NOTE]
>
> <span data-ttu-id="642cd-220">省略することができます、`DbSet<Enrollment>`と`DbSet<Course>`ステートメントと同じように動作します。</span><span class="sxs-lookup"><span data-stu-id="642cd-220">You can omit the `DbSet<Enrollment>` and `DbSet<Course>` statements and it would work the same.</span></span> <span data-ttu-id="642cd-221">Entity Framework はそれらを含める暗黙的に、`Student`エンティティ参照、`Enrollment`エンティティと`Enrollment`エンティティ参照、`Course`エンティティ。</span><span class="sxs-lookup"><span data-stu-id="642cd-221">Entity Framework would include them implicitly because the `Student` entity references the `Enrollment` entity and the `Enrollment` entity references the `Course` entity.</span></span>

### <a name="specify-the-connection-string"></a><span data-ttu-id="642cd-222">接続文字列を指定します。</span><span class="sxs-lookup"><span data-stu-id="642cd-222">Specify the connection string</span></span>

<span data-ttu-id="642cd-223">(これは後で、Web.config ファイルに追加されます) 接続文字列の名前で、コンストラクターに渡されます。</span><span class="sxs-lookup"><span data-stu-id="642cd-223">The name of the connection string (which you'll add to the Web.config file later) is passed in to the constructor.</span></span>

[!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample7.cs?highlight=1)]

<span data-ttu-id="642cd-224">現在、Web.config ファイルに格納されているいずれかの名前ではなく、接続文字列自体に渡すこともできます。</span><span class="sxs-lookup"><span data-stu-id="642cd-224">You could also pass in the connection string itself instead of the name of one that is stored in the Web.config file.</span></span> <span data-ttu-id="642cd-225">使用するデータベースを指定するためのオプションの詳細については、[接続文字列とモデル](/ef/ef6/fundamentals/configuring/connection-strings)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-225">For more information about options for specifying the database to use, see [Connection strings and models](/ef/ef6/fundamentals/configuring/connection-strings).</span></span>

<span data-ttu-id="642cd-226">接続文字列またはいずれかの名前を明示的に指定しない場合、Entity Framework では、接続文字列名は、クラス名と同じ前提としています。</span><span class="sxs-lookup"><span data-stu-id="642cd-226">If you don't specify a connection string or the name of one explicitly, Entity Framework assumes that the connection string name is the same as the class name.</span></span> <span data-ttu-id="642cd-227">この例では既定の接続文字列名になりますし`SchoolContext`、明示的に指定しているものと同じです。</span><span class="sxs-lookup"><span data-stu-id="642cd-227">The default connection string name in this example would then be `SchoolContext`, the same as what you're specifying explicitly.</span></span>

### <a name="specify-singular-table-names"></a><span data-ttu-id="642cd-228">単数のテーブル名を指定します。</span><span class="sxs-lookup"><span data-stu-id="642cd-228">Specify singular table names</span></span>

<span data-ttu-id="642cd-229">`modelBuilder.Conventions.Remove`内のステートメント、 [OnModelCreating](https://msdn.microsoft.com/library/system.data.entity.dbcontext.onmodelcreating(v=vs.103).aspx)メソッドは、複数の中からテーブル名を防ぎます。</span><span class="sxs-lookup"><span data-stu-id="642cd-229">The `modelBuilder.Conventions.Remove` statement in the [OnModelCreating](https://msdn.microsoft.com/library/system.data.entity.dbcontext.onmodelcreating(v=vs.103).aspx) method prevents table names from being pluralized.</span></span> <span data-ttu-id="642cd-230">このしなかった場合、データベースで生成されたテーブルの名前は`Students`、 `Courses`、および`Enrollments`します。</span><span class="sxs-lookup"><span data-stu-id="642cd-230">If you didn't do this, the generated tables in the database would be named `Students`, `Courses`, and `Enrollments`.</span></span> <span data-ttu-id="642cd-231">代わりに、テーブル名になります`Student`、 `Course`、および`Enrollment`します。</span><span class="sxs-lookup"><span data-stu-id="642cd-231">Instead, the table names will be `Student`, `Course`, and `Enrollment`.</span></span> <span data-ttu-id="642cd-232">テーブル名を複数形にするかどうかについては、開発者の間で意見が分かれるでしょう。</span><span class="sxs-lookup"><span data-stu-id="642cd-232">Developers disagree about whether table names should be pluralized or not.</span></span> <span data-ttu-id="642cd-233">このチュートリアルは、単数形を使用しますが、重要な点が含むかのコード行を省略すると、希望するどのフォームを選択することができます。</span><span class="sxs-lookup"><span data-stu-id="642cd-233">This tutorial uses the singular form, but the important point is that you can select whichever form you prefer by including or omitting this line of code.</span></span>

## <a name="initialize-db-with-test-data"></a><span data-ttu-id="642cd-234">テスト データで DB を初期化する</span><span class="sxs-lookup"><span data-stu-id="642cd-234">Initialize DB with test data</span></span>

<span data-ttu-id="642cd-235">Entity Framework できます自動的に作成 (または削除して再作成) すると、アプリケーションの実行時のデータベース。</span><span class="sxs-lookup"><span data-stu-id="642cd-235">Entity Framework can automatically create (or drop and re-create) a database for you when the application runs.</span></span> <span data-ttu-id="642cd-236">アプリケーションを実行するたびに、または既存のデータベースと同期されていません。 モデルの場合にのみこの行わ 必要がありますを指定できます。</span><span class="sxs-lookup"><span data-stu-id="642cd-236">You can specify that this should be done every time your application runs or only when the model is out of sync with the existing database.</span></span> <span data-ttu-id="642cd-237">記述することも、`Seed`その Entity Framework メソッドのテスト データを格納するために、データベースを作成した後。</span><span class="sxs-lookup"><span data-stu-id="642cd-237">You can also write a `Seed` method that Entity Framework automatically calls after creating the database in order to populate it with test data.</span></span>

<span data-ttu-id="642cd-238">既定の動作では、それが存在しない (とモデルが変更され、データベースが既に存在する場合に例外をスロー) 場合にのみデータベースを作成します。</span><span class="sxs-lookup"><span data-stu-id="642cd-238">The default behavior is to create a database only if it doesn't exist (and throw an exception if the model has changed and the database already exists).</span></span> <span data-ttu-id="642cd-239">このセクションでは、データベースを削除し、モデルが変更されるたびを再作成するを指定します。</span><span class="sxs-lookup"><span data-stu-id="642cd-239">In this section, you'll specify that the database should be dropped and re-created whenever the model changes.</span></span> <span data-ttu-id="642cd-240">データベースを削除すると、すべてのデータの損失とします。</span><span class="sxs-lookup"><span data-stu-id="642cd-240">Dropping the database causes the loss of all your data.</span></span> <span data-ttu-id="642cd-241">これは、一般に開発中なので問題は、`Seed`メソッドは、データベースの再作成、テスト データが再作成時に実行されます。</span><span class="sxs-lookup"><span data-stu-id="642cd-241">This is generally okay during development, because the `Seed` method will run when the database is re-created and will re-create your test data.</span></span> <span data-ttu-id="642cd-242">運用環境で一般的にしたくない、データベース スキーマを変更する必要があるたびに、すべてのデータが失われます。</span><span class="sxs-lookup"><span data-stu-id="642cd-242">But in production you generally don't want to lose all your data every time you need to change the database schema.</span></span> <span data-ttu-id="642cd-243">後で削除して、データベースを再作成ではなく、データベース スキーマを変更する Code First Migrations を使用してモデルの変更を処理する方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="642cd-243">Later you'll see how to handle model changes by using Code First Migrations to change the database schema instead of dropping and re-creating the database.</span></span>

1. <span data-ttu-id="642cd-244">という名前の新しいクラス ファイルを作成、DAL フォルダーで*SchoolInitializer.cs*負荷テスト、新しいデータベースにデータと、テンプレート コードをデータベースに必要な時に作成されると、次のコードに置き換えます。</span><span class="sxs-lookup"><span data-stu-id="642cd-244">In the DAL folder, create a new class file named *SchoolInitializer.cs* and replace the template code with the following code, which causes a database to be created when needed and loads test data into the new database.</span></span>

   [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample8.cs)]

   <span data-ttu-id="642cd-245">`Seed`メソッドは、入力パラメーターとして、データベース コンテキストのオブジェクトとメソッドのコードがそのオブジェクトを使用して、データベースに新しいエンティティを追加します。</span><span class="sxs-lookup"><span data-stu-id="642cd-245">The `Seed` method takes the database context object as an input parameter, and the code in the method uses that object to add new entities to the database.</span></span> <span data-ttu-id="642cd-246">エンティティ型ごとに、コードは、新しいエンティティのコレクションを作成、適切なに追加します`DbSet`プロパティ、および、データベースへの変更を保存します。</span><span class="sxs-lookup"><span data-stu-id="642cd-246">For each entity type, the code creates a collection of new  entities, adds them to the appropriate `DbSet` property, and then saves the changes to the database.</span></span> <span data-ttu-id="642cd-247">呼び出す必要はありません、`SaveChanges`エンティティの各グループの後にメソッドは、ここでは、として行われますが、これを行うコードは、データベースに書き込んでいるときに例外が発生した場合は、問題の原因を見つけることができます。</span><span class="sxs-lookup"><span data-stu-id="642cd-247">It isn't necessary to call the `SaveChanges` method after each group of entities, as is done here, but doing that helps you locate the source of a problem if an exception occurs while the code is writing to the database.</span></span>

2. <span data-ttu-id="642cd-248">初期化子クラスを使用する Entity Framework を指示するには、要素を追加、`entityFramework`アプリケーション内の要素*Web.config*ファイル (ファイル、ルート プロジェクト フォルダー内)、次の例に示すようにします。</span><span class="sxs-lookup"><span data-stu-id="642cd-248">To tell Entity Framework to use your initializer class, add an element to the `entityFramework` element in the application *Web.config* file (the one in the root project folder), as shown in the following example:</span></span>

   [!code-xml[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample9.xml?highlight=2-6)]

   <span data-ttu-id="642cd-249">`context type`コンテキストの完全修飾クラス名とには、アセンブリを指定します、`databaseinitializer type`と内にあるアセンブリの初期化子クラスの完全修飾名を指定します。</span><span class="sxs-lookup"><span data-stu-id="642cd-249">The `context type` specifies the fully qualified context class name and the assembly it's in, and the `databaseinitializer type` specifies the fully qualified name of the initializer class and the assembly it's in.</span></span> <span data-ttu-id="642cd-250">(で属性を設定するには、初期化子を使用する EF をしたくない場合、`context`要素: `disableDatabaseInitialization="true"`)。詳細については、[構成ファイルの設定](/ef/ef6/fundamentals/configuring/config-file)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-250">(When you don't want EF to use the initializer, you can set an attribute on the `context` element: `disableDatabaseInitialization="true"`.) For more information, see [Configuration File Settings](/ef/ef6/fundamentals/configuring/config-file).</span></span>

   <span data-ttu-id="642cd-251">初期化子を設定する代わりに、 *Web.config*ファイルを追加してコードで行うが、`Database.SetInitializer`ステートメントを`Application_Start`メソッドで、 *Global.asax.cs*ファイル。</span><span class="sxs-lookup"><span data-stu-id="642cd-251">An alternative to setting the initializer in the *Web.config* file is to do it in code by adding a `Database.SetInitializer` statement to the `Application_Start` method in the *Global.asax.cs* file.</span></span> <span data-ttu-id="642cd-252">詳細については、[Entity Framework Code First でデータベース初期化子を理解する](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-252">For more information, see [Understanding Database Initializers in Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm).</span></span>

<span data-ttu-id="642cd-253">アプリケーションは Entity Framework がモデルにデータベースを比較し、アプリケーションの特定の実行で初めてデータベースにアクセスするときにできるように、今すぐを設定 (、`SchoolContext`とエンティティ クラス)。</span><span class="sxs-lookup"><span data-stu-id="642cd-253">The application is now set up so that when you access the database for the first time in a given run of the application, Entity Framework compares the database to the model (your `SchoolContext` and entity classes).</span></span> <span data-ttu-id="642cd-254">違いがある場合、アプリケーションは削除し、データベースを再作成します。</span><span class="sxs-lookup"><span data-stu-id="642cd-254">If there's a difference, the application drops and re-creates the database.</span></span>

> [!NOTE]
> <span data-ttu-id="642cd-255">実稼働 web サーバーにアプリケーションを展開するときに、削除するか、削除し、データベースを再作成するコードを無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="642cd-255">When you deploy an application to a production web server, you must remove or disable code that drops and re-creates the database.</span></span> <span data-ttu-id="642cd-256">このシリーズの以降のチュートリアルを実行してみましょう。</span><span class="sxs-lookup"><span data-stu-id="642cd-256">You'll do that in a later tutorial in this series.</span></span>

## <a name="set-up-ef-6-to-use-localdb"></a><span data-ttu-id="642cd-257">LocalDB を使用するよう EF 6 に設定します。</span><span class="sxs-lookup"><span data-stu-id="642cd-257">Set up EF 6 to use LocalDB</span></span>

<span data-ttu-id="642cd-258">[LocalDB](/sql/database-engine/configure-windows/sql-server-2016-express-localdb?view=sql-server-2017)は、SQL Server Express データベース エンジンの軽量バージョンです。</span><span class="sxs-lookup"><span data-stu-id="642cd-258">[LocalDB](/sql/database-engine/configure-windows/sql-server-2016-express-localdb?view=sql-server-2017) is a lightweight version of the SQL Server Express database engine.</span></span> <span data-ttu-id="642cd-259">簡単にインストールして構成するには、オンデマンドで開始およびユーザー モードで実行します。</span><span class="sxs-lookup"><span data-stu-id="642cd-259">It's easy to install and configure, starts on demand, and runs in user mode.</span></span> <span data-ttu-id="642cd-260">LocalDB は SQL Server Express データベースとして使用することができますの特殊な実行モードで実行 *.mdf*ファイル。</span><span class="sxs-lookup"><span data-stu-id="642cd-260">LocalDB runs in a special execution mode of SQL Server Express that enables you to work with databases as *.mdf* files.</span></span> <span data-ttu-id="642cd-261">LocalDB のデータベース ファイルを配置することができます、*アプリ\_データ*プロジェクトにデータベースをコピーする場合は、web プロジェクトのフォルダー。</span><span class="sxs-lookup"><span data-stu-id="642cd-261">You can put LocalDB database files in the *App\_Data* folder of a web project if you want to be able to copy the database with the project.</span></span> <span data-ttu-id="642cd-262">SQL Server express ユーザー インスタンス機能では使用することもできます *.mdf*ユーザー インスタンスの機能は、ファイルが非推奨とされます。 そのため、LocalDB を使用するため推奨 *.mdf*ファイル。</span><span class="sxs-lookup"><span data-stu-id="642cd-262">The user instance feature in SQL Server Express also enables you to work with *.mdf* files, but the user instance feature is deprecated; therefore, LocalDB is recommended for working with *.mdf* files.</span></span> <span data-ttu-id="642cd-263">LocalDB は、Visual Studio では、既定でインストールされます。</span><span class="sxs-lookup"><span data-stu-id="642cd-263">LocalDB is installed by default with Visual Studio.</span></span>

<span data-ttu-id="642cd-264">通常、実稼働 web アプリケーションの SQL Server Express は使用されません。</span><span class="sxs-lookup"><span data-stu-id="642cd-264">Typically, SQL Server Express is not used for production web applications.</span></span> <span data-ttu-id="642cd-265">LocalDB 具体的には使用しないで web アプリケーションを運用環境で使用ため、これは、IIS を使用する意図していません。</span><span class="sxs-lookup"><span data-stu-id="642cd-265">LocalDB in particular is not recommended for production use with a web application because it's not designed to work with IIS.</span></span>

- <span data-ttu-id="642cd-266">このチュートリアルでは、LocalDB を使用します。</span><span class="sxs-lookup"><span data-stu-id="642cd-266">In this tutorial, you'll work with LocalDB.</span></span> <span data-ttu-id="642cd-267">アプリケーションを開く*Web.config*追加ファイルを開き、`connectionStrings`前の要素、`appSettings`要素は、次の例に示すようにします。</span><span class="sxs-lookup"><span data-stu-id="642cd-267">Open the application *Web.config* file and add a `connectionStrings` element preceding the `appSettings` element, as shown in the following example.</span></span> <span data-ttu-id="642cd-268">(必ず更新して、 *Web.config*ルート プロジェクト フォルダー内のファイル。</span><span class="sxs-lookup"><span data-stu-id="642cd-268">(Make sure you update the *Web.config* file in the root project folder.</span></span> <span data-ttu-id="642cd-269">*Web.config*ファイル、*ビュー*サブフォルダーを更新する必要はありません)。</span><span class="sxs-lookup"><span data-stu-id="642cd-269">There's also a *Web.config* file in the *Views* subfolder that you don't need to update.)</span></span>

   [!code-xml[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample10.xml?highlight=1-3)]

<span data-ttu-id="642cd-270">追加した接続文字列は、Entity Framework がという名前の LocalDB データベースを使用するを指定します*ContosoUniversity1.mdf*します。</span><span class="sxs-lookup"><span data-stu-id="642cd-270">The connection string you've added specifies that Entity Framework will use a LocalDB database named *ContosoUniversity1.mdf*.</span></span> <span data-ttu-id="642cd-271">(データベースがまだ存在しないが EF によって作成されます)。データベースを作成する場合、*アプリ\_データ*でしたを追加するフォルダー、`AttachDBFilename=|DataDirectory|\ContosoUniversity1.mdf`接続文字列にします。</span><span class="sxs-lookup"><span data-stu-id="642cd-271">(The database doesn't exist yet but EF will create it.) If you want to create the database in your *App\_Data* folder, you could add `AttachDBFilename=|DataDirectory|\ContosoUniversity1.mdf` to the connection string.</span></span> <span data-ttu-id="642cd-272">接続文字列の詳細については、[ASP.NET Web アプリケーションの SQL Server 接続文字列](/previous-versions/aspnet/jj653752(v=vs.110))を参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-272">For more information about connection strings, see [SQL Server Connection Strings for ASP.NET Web Applications](/previous-versions/aspnet/jj653752(v=vs.110)).</span></span>

<span data-ttu-id="642cd-273">内の接続文字列を実際には必要はありません、 *Web.config*ファイル。</span><span class="sxs-lookup"><span data-stu-id="642cd-273">You don't actually need a connection string in the *Web.config* file.</span></span> <span data-ttu-id="642cd-274">接続文字列を指定しない場合、Entity Framework には、コンテキスト クラスに基づいた既定の接続文字列が使用されます。</span><span class="sxs-lookup"><span data-stu-id="642cd-274">If you don't supply a connection string, Entity Framework uses a default connection string based on your context class.</span></span> <span data-ttu-id="642cd-275">詳細については、[新しいデータベースを Code First](/ef/ef6/modeling/code-first/workflows/new-database)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-275">For more information, see [Code First to a New Database](/ef/ef6/modeling/code-first/workflows/new-database).</span></span>

## <a name="create-controller-and-views"></a><span data-ttu-id="642cd-276">コントローラーとビューを作成する</span><span class="sxs-lookup"><span data-stu-id="642cd-276">Create controller and views</span></span>

<span data-ttu-id="642cd-277">これでデータを表示する web ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="642cd-277">Now you'll create a web page to display data.</span></span> <span data-ttu-id="642cd-278">データを自動的に要求するプロセスは、データベースの作成をトリガーします。</span><span class="sxs-lookup"><span data-stu-id="642cd-278">The process of requesting the data automatically triggers the creation of the database.</span></span> <span data-ttu-id="642cd-279">新しいコント ローラーの作成から始めます。</span><span class="sxs-lookup"><span data-stu-id="642cd-279">You'll begin by creating a new controller.</span></span> <span data-ttu-id="642cd-280">その前に、モデルおよびコンテキスト クラスを MVC コント ローラーのスキャフォールディングを使用できるようにプロジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="642cd-280">But before you do that, build the project to make the model and context classes available to MVC controller scaffolding.</span></span>

1. <span data-ttu-id="642cd-281">右クリックし、**コント ローラー**フォルダー**ソリューション エクスプ ローラー**を選択します**追加**、 をクリックし、**スキャフォールディングされた新しい項目**します。</span><span class="sxs-lookup"><span data-stu-id="642cd-281">Right-click the **Controllers** folder in **Solution Explorer**, select **Add**, and then click **New Scaffolded Item**.</span></span>
2. <span data-ttu-id="642cd-282">**スキャフォールディングの追加**ダイアログ ボックスで、 **MVC 5 コント ローラーとビュー、Entity Framework を使用して**を選び、**追加**します。</span><span class="sxs-lookup"><span data-stu-id="642cd-282">In the **Add Scaffold** dialog box, select **MVC 5 Controller with views, using Entity Framework**, and then choose **Add**.</span></span>

     ![Visual Studio でスキャフォールディング ダイアログ ボックスを追加します。](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/add-scaffold.png)

3. <span data-ttu-id="642cd-284">**コント ローラーの追加**ダイアログ ボックスで、次の項目を選択し、**追加**:</span><span class="sxs-lookup"><span data-stu-id="642cd-284">In the **Add Controller** dialog box, make the following selections, and then choose **Add**:</span></span>

   - <span data-ttu-id="642cd-285">モデル クラス:**学生 (ContosoUniversity.Models)** します。</span><span class="sxs-lookup"><span data-stu-id="642cd-285">Model class: **Student (ContosoUniversity.Models)**.</span></span> <span data-ttu-id="642cd-286">(プロジェクトのビルド ドロップダウン リストでは、このオプションが表示されない場合ともう一度やり直してください。)</span><span class="sxs-lookup"><span data-stu-id="642cd-286">(If you don't see this option in the drop-down list, build the project and try again.)</span></span>
   - <span data-ttu-id="642cd-287">データ コンテキスト クラス:**[Schoolcontext] (ContosoUniversity.DAL)** します。</span><span class="sxs-lookup"><span data-stu-id="642cd-287">Data context class: **SchoolContext (ContosoUniversity.DAL)**.</span></span>
   - <span data-ttu-id="642cd-288">コント ローラー名:**StudentController** (StudentsController されません)。</span><span class="sxs-lookup"><span data-stu-id="642cd-288">Controller name: **StudentController** (not StudentsController).</span></span>
   - <span data-ttu-id="642cd-289">その他のフィールドの既定値のままにします。</span><span class="sxs-lookup"><span data-stu-id="642cd-289">Leave the default values for the other fields.</span></span>

     <span data-ttu-id="642cd-290">クリックすると**追加**をスキャフォールダーの作成、 *StudentController.cs*ファイルと、一連のビュー (*.cshtml*ファイル)、コント ローラーと連動します。</span><span class="sxs-lookup"><span data-stu-id="642cd-290">When you click **Add**, the scaffolder creates a *StudentController.cs* file and a set of views (*.cshtml* files) that work with the controller.</span></span> <span data-ttu-id="642cd-291">今後の Entity Framework を使用するプロジェクトを作成する場合は、ことができますも活用する、スキャフォールダーの追加機能の一部: 最初のモデル クラスを作成、接続文字列を作成しませんし、 **追加コントローラー**ボックス指定**新しいデータ コンテキスト**を選択して、 **+** 横に**データ コンテキスト クラス**します。</span><span class="sxs-lookup"><span data-stu-id="642cd-291">In the future when you create projects that use Entity Framework, you can also take advantage of some additional functionality of the scaffolder: create your first model class, don't create a connection string, and then in the **Add Controller** box specify **New data context** by selecting the **+** button next to **Data context class**.</span></span> <span data-ttu-id="642cd-292">スキャフォールダーの作成、`DbContext`だけでなく、コント ローラーおよびビューのクラスとの接続文字列します。</span><span class="sxs-lookup"><span data-stu-id="642cd-292">The scaffolder will create your `DbContext` class and your connection string as well as the controller and views.</span></span>
4. <span data-ttu-id="642cd-293">Visual Studio を開き、 *Controllers\StudentController.cs*ファイル。</span><span class="sxs-lookup"><span data-stu-id="642cd-293">Visual Studio opens the *Controllers\StudentController.cs* file.</span></span> <span data-ttu-id="642cd-294">クラスの変数が作成されているデータベースのコンテキスト オブジェクトをインスタンス化するを参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-294">You see that a class variable has been created that instantiates a database context object:</span></span>

     [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample11.cs)]

     <span data-ttu-id="642cd-295">`Index`アクション メソッドから受講者の一覧を取得する、*学生*エンティティ セットを読み取ることによって、`Students`データベース コンテキスト インスタンスのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="642cd-295">The `Index` action method gets a list of students from the *Students* entity set by reading the `Students` property of the database context instance:</span></span>

     [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample12.cs)]

     <span data-ttu-id="642cd-296">*Student\Index.cshtml*ビューは、テーブルのこの一覧を表示します。</span><span class="sxs-lookup"><span data-stu-id="642cd-296">The *Student\Index.cshtml* view displays this list in a table:</span></span>

     [!code-cshtml[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample13.cshtml)]
5. <span data-ttu-id="642cd-297">Ctrl + f5 キーを押してプロジェクトを実行します。</span><span class="sxs-lookup"><span data-stu-id="642cd-297">Press Ctrl+F5 to run the project.</span></span> <span data-ttu-id="642cd-298">(「シャドウ コピーを作成できません」エラーが発生する場合、ブラウザーを閉じてもう一度お試し。)</span><span class="sxs-lookup"><span data-stu-id="642cd-298">(If you get a "Cannot create Shadow Copy" error, close the browser and try again.)</span></span>

     <span data-ttu-id="642cd-299">をクリックして、**学生**テスト データを表示するタブを`Seed`メソッドを挿入します。</span><span class="sxs-lookup"><span data-stu-id="642cd-299">Click the **Students** tab to see the test data that the `Seed` method inserted.</span></span> <span data-ttu-id="642cd-300">どの幅の狭いブラウザー ウィンドウが、最上位のアドレス バーに受講者 タブのリンクが表示されますかに応じてへのリンクを参照してください。 右上隅をクリックする必要があります。</span><span class="sxs-lookup"><span data-stu-id="642cd-300">Depending on how narrow your browser window is, you'll see the Student tab link in the top address bar or you'll have to click the upper right corner to see the link.</span></span>

     ![メニュー ボタン](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/image14.png)

## <a name="view-the-database"></a><span data-ttu-id="642cd-302">データベースを表示する</span><span class="sxs-lookup"><span data-stu-id="642cd-302">View the database</span></span>

<span data-ttu-id="642cd-303">Students のページを実行すると、アプリケーションが、データベースにアクセスしようとしています。、EF はデータベースがないと、1 つずつ作成があることを検出します。</span><span class="sxs-lookup"><span data-stu-id="642cd-303">When you ran the Students page and the application tried to access the database, EF discovered that there was no database and created one.</span></span> <span data-ttu-id="642cd-304">EF は、データベースにデータを設定するシード メソッドを実行します。</span><span class="sxs-lookup"><span data-stu-id="642cd-304">EF then ran the seed method to populate the database with data.</span></span>

<span data-ttu-id="642cd-305">いずれかを使用する**サーバー エクスプ ローラー**または**SQL Server オブジェクト エクスプ ローラー** Visual Studio でデータベースを表示するには、(SSOX)。</span><span class="sxs-lookup"><span data-stu-id="642cd-305">You can use either **Server Explorer** or **SQL Server Object Explorer** (SSOX) to view the database in Visual Studio.</span></span> <span data-ttu-id="642cd-306">このチュートリアルで使用する**サーバー エクスプ ローラー**します。</span><span class="sxs-lookup"><span data-stu-id="642cd-306">For this tutorial, you'll use **Server Explorer**.</span></span>

1. <span data-ttu-id="642cd-307">ブラウザーを閉じます。</span><span class="sxs-lookup"><span data-stu-id="642cd-307">Close the browser.</span></span>
2. <span data-ttu-id="642cd-308">**サーバー エクスプ ローラー**、展開**データ接続**(最初に更新 ボタンを選択する必要があります、) 展開**学校のコンテキスト (ContosoUniversity)** 順に展開**テーブル**に新しいデータベースのテーブルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-308">In **Server Explorer**, expand **Data Connections** (you may need to select the refresh button first), expand **School Context (ContosoUniversity)**, and then expand **Tables** to see the tables in your new database.</span></span>

3. <span data-ttu-id="642cd-309">右クリックし、**学生**テーブルし、クリックして**テーブル データの表示**に作成された列とテーブルに挿入された行を参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-309">Right-click the **Student** table and click **Show Table Data** to see the columns that were created and the rows that were inserted into the table.</span></span>

4. <span data-ttu-id="642cd-310">閉じる、**サーバー エクスプ ローラー**接続します。</span><span class="sxs-lookup"><span data-stu-id="642cd-310">Close the **Server Explorer** connection.</span></span>

<span data-ttu-id="642cd-311">*ContosoUniversity1.mdf*と *.ldf*データベース ファイルは、 *%userprofile%* フォルダー。</span><span class="sxs-lookup"><span data-stu-id="642cd-311">The *ContosoUniversity1.mdf* and *.ldf* database files are in the *%USERPROFILE%* folder.</span></span>

<span data-ttu-id="642cd-312">使用しているため、`DropCreateDatabaseIfModelChanges`初期化子、行うことができますようになりましたへの変更、`Student`クラス、アプリケーションを再実行、およびデータベースに再作成された、変更に合わせて自動的になります。</span><span class="sxs-lookup"><span data-stu-id="642cd-312">Because you're using the `DropCreateDatabaseIfModelChanges` initializer, you could now make a change to the `Student` class, run the application again, and the database would automatically be re-created to match your change.</span></span> <span data-ttu-id="642cd-313">追加する場合など、`EmailAddress`プロパティを`Student`クラス、学生のページを再度実行して、参照した後の表に、もう一度、表示、新しい`EmailAddress`列。</span><span class="sxs-lookup"><span data-stu-id="642cd-313">For example, if you add an `EmailAddress` property to the `Student` class, run the Students page again, and then look at the table again, you'll see a new `EmailAddress` column.</span></span>

## <a name="conventions"></a><span data-ttu-id="642cd-314">規約</span><span class="sxs-lookup"><span data-stu-id="642cd-314">Conventions</span></span>

<span data-ttu-id="642cd-315">完全なデータベースを作成できるように Entity Framework の順序で記述する必要があるコードの量は最小限のため*規則*、または Entity Framework は、想定します。</span><span class="sxs-lookup"><span data-stu-id="642cd-315">The amount of code you had to write in order for Entity Framework to be able to create a complete database for you is minimal because of *conventions*, or assumptions that Entity Framework makes.</span></span> <span data-ttu-id="642cd-316">既に説明した一部の場合、または自分がそれらを認識せずに使用されていたは。</span><span class="sxs-lookup"><span data-stu-id="642cd-316">Some of them have already been noted or were used without your being aware of them:</span></span>

- <span data-ttu-id="642cd-317">エンティティ クラス名の複数形のフォームは、テーブル名として使用されます。</span><span class="sxs-lookup"><span data-stu-id="642cd-317">The pluralized forms of entity class names are used as table names.</span></span>
- <span data-ttu-id="642cd-318">列名には、エンティティ プロパティ名が使用されます。</span><span class="sxs-lookup"><span data-stu-id="642cd-318">Entity property names are used for column names.</span></span>
- <span data-ttu-id="642cd-319">という名前のエンティティ プロパティ`ID`または*classname* `ID`主キー プロパティとして認識されます。</span><span class="sxs-lookup"><span data-stu-id="642cd-319">Entity properties that are named `ID` or *classname* `ID` are recognized as primary key properties.</span></span>
- <span data-ttu-id="642cd-320">という名前が場合、外部キー プロパティとして、プロパティの解釈 *&lt;ナビゲーション プロパティの名前&gt;&lt;主キー プロパティ名&gt;* (たとえば、 `StudentID` の`Student`からナビゲーション プロパティ、`Student`エンティティの主キーが`ID`)。</span><span class="sxs-lookup"><span data-stu-id="642cd-320">A property is interpreted as a foreign key property if it's named *&lt;navigation property name&gt;&lt;primary key property name&gt;* (for example, `StudentID` for the `Student` navigation property since the `Student` entity's primary key is `ID`).</span></span> <span data-ttu-id="642cd-321">外部キー プロパティできますも同じ名前に単に&lt;主キー プロパティ名&gt;(たとえば、`EnrollmentID`ので、`Enrollment`エンティティの主キーが`EnrollmentID`)。</span><span class="sxs-lookup"><span data-stu-id="642cd-321">Foreign key properties can also be named the same simply &lt;primary key property name&gt; (for example, `EnrollmentID` since the `Enrollment` entity's primary key is `EnrollmentID`).</span></span>

<span data-ttu-id="642cd-322">規則をオーバーライドできることを見てきました。</span><span class="sxs-lookup"><span data-stu-id="642cd-322">You've seen that conventions can be overridden.</span></span> <span data-ttu-id="642cd-323">たとえば、テーブル名を複数化しないでくださいと、後述することを指定を外部キー プロパティとしてプロパティを明示的にマークする方法。</span><span class="sxs-lookup"><span data-stu-id="642cd-323">For example, you specified that table names shouldn't be pluralized, and you'll see later how to explicitly mark a property as a foreign key property.</span></span>

## <a name="get-the-code"></a><span data-ttu-id="642cd-324">コードを取得する</span><span class="sxs-lookup"><span data-stu-id="642cd-324">Get the code</span></span>

[<span data-ttu-id="642cd-325">完成したプロジェクトのダウンロード</span><span class="sxs-lookup"><span data-stu-id="642cd-325">Download Completed Project</span></span>](https://webpifeed.blob.core.windows.net/webpifeed/Partners/ASP.NET%20MVC%20Application%20Using%20Entity%20Framework%20Code%20First.zip)

## <a name="additional-resources"></a><span data-ttu-id="642cd-326">その他の技術情報</span><span class="sxs-lookup"><span data-stu-id="642cd-326">Additional resources</span></span>

<span data-ttu-id="642cd-327">詳細については、EF 6 は、次の記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="642cd-327">For more about EF 6, see these articles:</span></span>

* [<span data-ttu-id="642cd-328">ASP.NET データ アクセス - 推奨リソース</span><span class="sxs-lookup"><span data-stu-id="642cd-328">ASP.NET Data Access - Recommended Resources</span></span>](../../../../whitepapers/aspnet-data-access-content-map.md)

* [<span data-ttu-id="642cd-329">コードの最初の規則</span><span class="sxs-lookup"><span data-stu-id="642cd-329">Code First Conventions</span></span>](/ef/ef6/modeling/code-first/conventions/built-in)

* [<span data-ttu-id="642cd-330">より複雑なデータ モデルを作成する</span><span class="sxs-lookup"><span data-stu-id="642cd-330">Creating a More Complex Data Model</span></span>](creating-a-more-complex-data-model-for-an-asp-net-mvc-application.md)

## <a name="next-steps"></a><span data-ttu-id="642cd-331">次の手順</span><span class="sxs-lookup"><span data-stu-id="642cd-331">Next steps</span></span>

<span data-ttu-id="642cd-332">このチュートリアルでは、次の作業を行いました。</span><span class="sxs-lookup"><span data-stu-id="642cd-332">In this tutorial, you:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="642cd-333">MVC web アプリの作成</span><span class="sxs-lookup"><span data-stu-id="642cd-333">Created an MVC web app</span></span>
> * <span data-ttu-id="642cd-334">サイトのスタイルを設定する</span><span class="sxs-lookup"><span data-stu-id="642cd-334">Set up the site style</span></span>
> * <span data-ttu-id="642cd-335">インストールされている Entity Framework 6</span><span class="sxs-lookup"><span data-stu-id="642cd-335">Installed Entity Framework 6</span></span>
> * <span data-ttu-id="642cd-336">データ モデルを作成した</span><span class="sxs-lookup"><span data-stu-id="642cd-336">Created the data model</span></span>
> * <span data-ttu-id="642cd-337">データベース コンテキストを作成した</span><span class="sxs-lookup"><span data-stu-id="642cd-337">Created the database context</span></span>
> * <span data-ttu-id="642cd-338">テスト データで DB を初期化した</span><span class="sxs-lookup"><span data-stu-id="642cd-338">Initialized DB with test data</span></span>
> * <span data-ttu-id="642cd-339">LocalDB を使用するよう EF 6 に設定します。</span><span class="sxs-lookup"><span data-stu-id="642cd-339">Set up EF 6 to use LocalDB</span></span>
> * <span data-ttu-id="642cd-340">コントローラーとビューを作成した</span><span class="sxs-lookup"><span data-stu-id="642cd-340">Created controller and views</span></span>
> * <span data-ttu-id="642cd-341">データベースを表示した</span><span class="sxs-lookup"><span data-stu-id="642cd-341">Viewed the database</span></span>

<span data-ttu-id="642cd-342">確認しカスタマイズの作成、読み取り、更新、コント ローラーとビューの (CRUD) のコードを削除する方法については、次の記事に進んでください。</span><span class="sxs-lookup"><span data-stu-id="642cd-342">Advance to the next article to learn how to review and customize the create, read, update, delete (CRUD) code in your controllers and views.</span></span>
> [!div class="nextstepaction"]
> [<span data-ttu-id="642cd-343">基本 CRUD 機能を実装する</span><span class="sxs-lookup"><span data-stu-id="642cd-343">Implement basic CRUD functionality</span></span>](implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application.md)