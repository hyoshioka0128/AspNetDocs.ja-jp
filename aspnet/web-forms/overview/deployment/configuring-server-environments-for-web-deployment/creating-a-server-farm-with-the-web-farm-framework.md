---
uid: web-forms/overview/deployment/configuring-server-environments-for-web-deployment/creating-a-server-farm-with-the-web-farm-framework
title: Web Farm Framework でサーバー ファームを作成する |Microsoft Docs
author: jrjlee
description: このトピックでは、Web Farm Framework (WFF) 2.0 を使用して作成し、サーバーのコレクションからの web サーバー ファームを構成する方法について説明します。
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 656dd06d-806c-467c-863d-9fc45e5ba3ab
msc.legacyurl: /web-forms/overview/deployment/configuring-server-environments-for-web-deployment/creating-a-server-farm-with-the-web-farm-framework
msc.type: authoredcontent
ms.openlocfilehash: 19c061e83257e118aee74c9373a627b8c56defe3
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59421239"
---
# <a name="creating-a-server-farm-with-the-web-farm-framework"></a>Web Farm Framework でサーバー ファームを作成する

によって[Jason Lee](https://github.com/jrjlee)

[PDF のダウンロード](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> このトピックでは、Web Farm Framework (WFF) 2.0 を使用して作成し、サーバーのコレクションからの web サーバー ファームを構成する方法について説明します。


WFF では、複数の負荷分散された web サーバー、web platform 製品とコンポーネント、web アプリケーション、web サイト、および構成設定を同期できます。 ステージングと運用環境のように、1 つ以上の web サーバーが必要があるシナリオでこの大幅に、展開と構成プロセスを簡略化することができます。 1 台のサーバーへの web アプリケーションを展開する&#x2014;、*プライマリ サーバー*&#x2014;WFF のサーバー ファームの他のすべての web サーバーでは、その web アプリケーションを自動的にレプリケートするとします。

## <a name="understanding-the-web-farm-framework"></a>Web Farm Framework を理解します。

WFF 2.0 を使用して、プロビジョニング、管理、および web サーバーのグループにコンテンツを配置することができます。 WFF 展開は、3 つの主要なサーバー ロールで構成されます。

- *コント ローラー サーバー*します。 作成および WFF サーバー ファームを構成するには、このサーバーを使用します。 コント ローラーのサーバーでは、web プラットフォームのコンポーネント、構成設定、およびアプリケーション サーバー ファームの web サーバー間での同期を管理します。 コント ローラー サーバーを WFF 2.0 をインストールして、コント ローラーのサーバーは、サーバー ファーム内のサーバーの各 WFF agent をインストールにされます。 コント ローラーのサーバーは概念的には、WFF サーバー ファームに属していませんし、単一のコント ローラー サーバーは、複数のサーバー ファームを管理できます。 このシナリオでは、単一 WFF コント ローラー サーバーを使用して作成およびステージングのサーバー ファームと運用環境のサーバー ファームを管理します。
- *プライマリ サーバー*します。 各 WFF サーバー ファームには、1 つのプライマリ サーバーが含まれています。 Web プラットフォーム コンポーネントをインストールまたはプライマリ サーバーにアプリケーションを展開すると、WFF はサーバー ファームの他のすべてのサーバーへの変更を同期します。
- *セカンダリ サーバー*します。 各 WFF サーバー ファームには、1 つまたは複数のセカンダリ サーバーが含まれています。 プライマリ サーバーに行った変更は、サーバー ファーム内のすべてのセカンダリ サーバーにレプリケートされます。

これは、これらのサーバー ロールが、Fabrikam, Inc. のステージングと運用環境に関連付ける方法を示しています。

![](creating-a-server-farm-with-the-web-farm-framework/_static/image1.png)

このシナリオで、ステージング環境と運用環境は両方として構成 WFF サーバー ファーム。 1 つの WFF コント ローラー サーバーは、両方のファームを管理します。 各サーバー ファーム内では、プライマリ サーバーに変更は、すべてのセカンダリ サーバーにレプリケートされます。

ステージングと運用環境の構成を開始する前に、こちらの記事について理解を深める WFF 2.0 の主要な概念を確認することお勧めします。

- [Iis 7 Web Farm Framework 2.0 の概要](https://go.microsoft.com/?linkid=9805126)
- [IIS 7 では、Web Farm Framework 2.0 でのサーバー ファームの設定](https://go.microsoft.com/?linkid=9805127)
- [システムおよび IIS 7 Web Farm Framework 2.0 のプラットフォームの要件](https://go.microsoft.com/?linkid=9805128)

## <a name="task-overview"></a>タスクの概要

タスクとこのトピックの「チュートリアルを完了するには、少なくとも 3 台サーバー必要があります&#x2014;WFF コント ローラーが 1 つ、1 つのプライマリ web サーバー、サーバー ファームのサーバー ファームの 1 つまたは複数セカンダリの web サーバー。 いつでも WFF サーバー ファームに複数のセカンダリ サーバーを追加できます。 作成および構成する必要があります、ステージング環境または運用環境に WFF サーバー ファームの高レベル。

- インターネット インフォメーション サービス (IIS) 7.5 および WFF 2.0 をインストールすることによって、コント ローラー サーバーを作成します。
- プライマリとセカンダリ サーバーを準備するには、一般的な管理者アカウントを作成して、ファイアウォールの例外を構成します。
- サーバー ファームを構成するには、コント ローラーのサーバーで IIS マネージャーを使用します。
- IIS Application Request Routing (ARR) または別の負荷分散テクノロジを使用して負荷分散を構成します。

タスクとチュートリアルでは、このトピックでは、Windows Server 2008 R2 を実行しているサーバーのクリーン ビルドを開始することを想定しています。 サーバーごとに、開始する前にいることを確認します。

- Windows Server 2008 R2 Service Pack 1 とすべての利用可能な更新プログラムがインストールされます。
- サーバーは、ドメインに参加しています。
- サーバーは、静的 IP アドレスを持ちます。

> [!NOTE]
> コンピューターをドメインに参加させる方法については、次を参照してください。[に参加するコンピューターのドメインとログオン](https://technet.microsoft.com/library/cc725618(v=WS.10).aspx)します。 静的 IP アドレスの構成の詳細については、次を参照してください。[静的 IP アドレス構成](https://technet.microsoft.com/library/cc754203(v=ws.10).aspx)します。


## <a name="create-the-wff-controller-server"></a>WFF コント ローラーのサーバーを作成します。

WFF コント ローラーのサーバーを作成するには、IIS 7 以降と WFF 2.0 またはそれ以降の両方をインストールする必要があります。 WFF が IIS の Web 配置ツール (Web 配置) を使用して内部的には、2.x、ファーム内のサーバーを同期します。 WFF をインストールする、Web Platform Installer を使用する場合、インストーラーが自動的にダウンロードされ Web 配置をインストールできます。

**WFF コント ローラーのサーバーを作成するには**

1. ダウンロードしてインストール、 [Web Platform Installer](https://go.microsoft.com/?linkid=9739157)します。
2. 上部にある、 **Web Platform Installer 3.0**ウィンドウで、をクリックして**製品**します。
3. ナビゲーション ウィンドウで、ウィンドウの左側にある クリックして**Server**します。
4. **IIS 7 推奨構成**行で、をクリックして**追加**します。
5. <strong>Web Farm Framework 2</strong> 。<em>x</em>行で、をクリックして<strong>追加</strong>します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image2.png)
6. **[インストール]** をクリックします。 Web Platform Installer がインストールの一覧に Web 配置ツールのさまざまな他の依存関係と共にを追加することに注意してください。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image3.png)
7. ライセンス条項を確認し、条項に同意する場合にクリックします**同意**します。
8. インストールが完了したら、クリックして**完了**、閉じて、 **Web Platform Installer 3.0**ウィンドウ。

## <a name="configure-the-primary-and-secondary-servers"></a>プライマリとセカンダリ サーバーを構成します。

WFF サーバー ファームを作成する前に、web サーバー ファームを構成するには、いくつかの準備タスクを実行する必要があります。

- 許可するファイアウォール例外を追加、**コア ネットワーク**、**リモート管理**、および**ファイルとプリンターの共有**WFF コント ローラーのサーバーと通信する機能.
- ドメイン アカウントを作成する (たとえば、 **FABRIKAM\stagingfarm**) Active Directory でし、各サーバーでローカルの administrators グループに追加します。 サーバー ファームを作成するときに、サーバー ファームの管理者アカウントとしてこのアカウントを使用します。

Windows ファイアウォールでこれらのファイアウォール例外を構成する方法の詳細については、次を参照してください。[システムと IIS 7 Web Farm Framework 2.0 のプラットフォーム要件](https://go.microsoft.com/?linkid=9805128)します。 その他のファイアウォール システムは、製品のマニュアルを参照してください。

次の手順を使用して、Windows Server 2008 R2 でのローカルの administrators グループにドメイン アカウントを追加することができます。 サーバー ファームに追加するすべてのサーバーでこの手順を実行する必要があります&#x2014;つまり、プライマリ サーバーと各セカンダリ サーバーのローカル administrators グループに同じドメイン アカウントを追加します。

**ローカルの administrators グループにドメイン アカウントを追加するには**

1. **開始**メニューで、**管理ツール**、 をクリックし、**サーバー マネージャー**。
2. **サーバー マネージャー**ウィンドウのツリー ビュー ウィンドウで [**構成**、展開**ローカル ユーザーとグループ**、] をクリックし、**グループ**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image4.png)
3. **グループ**ウィンドウで、ダブルクリックして**管理者**します。
4. **Administrators のプロパティ**ダイアログ ボックスで、をクリックして**追加**します。
5. **[ユーザー、コンピューター、サービス アカウント、またはグループ**、ドメイン アカウント] ダイアログ ボックス、入力 (または参照) (たとえば、 **FABRIKAM\stagingfarm**)、順にクリックします**OK**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image5.png)
6. **Administrators のプロパティ**ダイアログ ボックスで、をクリックして**OK**します。

サーバーは、サーバー ファームに追加する準備ができました。 プライマリ サーバーの場合は前に、または後、サーバー ファームを作成するには、アプリケーションの要件を満たすためにサーバーを構成することができます&#x2014;どちらの場合で、WFF は、同じ製品、コンポーネント、または構成をデプロイすることで、サーバーが同期されますセカンダリ サーバーです。 このチュートリアルでは、わかりやすくする、サーバー ファームの作成が完了したら、プライマリ サーバーを構成することが想定しています。

## <a name="create-the-wff-server-farm"></a>WFF サーバー ファームを作成します。

この時点では、すべてのサーバーは、WFF サーバー ファームに追加できる状態には。

- WFF コント ローラー サーバーにインストールしました。
- プライマリとセカンダリの web サーバーに対するファイアウォールの例外を構成しました。
- プライマリとセカンダリの web サーバーでローカル administrators グループにドメイン アカウントを追加しました。

次の手順では、WFF でサーバー ファームを作成します。 実行できるこの IIS マネージャーから、WFF コント ローラーのサーバー。

**WFF サーバー ファームを作成するには**

1. WFF コント ローラーのサーバー上で、**開始**メニューで、**管理ツール**、順にクリックします**インターネット インフォメーション サービス (IIS) マネージャー**します。
2. **接続**ウィンドウで、ローカル サーバーのノードを展開し、右クリックして**サーバー ファーム**、 をクリックし、**サーバー ファームの作成**です。
3. **サーバー ファームの作成**] ダイアログ ボックスに、サーバー ファームのわかりやすい名前を入力 (たとえば、**ステージング ファーム**)、し、[**サーバー ファームをプロビジョニング**します。
4. ユーザー名と各サーバーでローカルの administrators グループに追加したドメイン アカウントのパスワードを入力します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image6.png)
5. **[次へ]** をクリックします。
6. **サーバーの追加**ページの選択のプライマリ サーバーの完全修飾ドメイン名 (FQDN) を入力**プライマリ サーバー**、 をクリックし、**追加**します。
7. この時点では、WFF は、指定した資格情報を使用して、プライマリ サーバーに接続を試みます。 テーブルにプライマリ サーバーを追加は、接続に成功した場合、**サーバーの追加**ページ。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image7.png)

    > [!NOTE]
    > お気付きかもしれませんを**サーバーが負荷分散の使用可能な**が既定で選択されています。 WFF では、IIS ARR モジュールを使用して、負荷分散を実装し、それによって、サーバー ファームで web サーバー間で要求を分散します。 ほとんどのシナリオではのみをオフにする、**サーバーが負荷分散の使用可能な**サードパーティの負荷分散ソリューションを代わりに使用する場合はオプションです。
8. **サーバーの追加** ページで、最初のセカンダリ サーバーの FQDN を入力してをクリックし、**追加**します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image8.png)
9. クリックして、ファームで追加のセカンダリ サーバーに対して手順 7**完了**します。

WFF サーバー ファームが起動し、実行します。 Web プラットフォームの製品や、プライマリ サーバーと web アプリケーションまたはプライマリ サーバーに展開するコンテンツをインストールするコンポーネントは、すべてのセカンダリ サーバーで自動的にプロビジョニングされます。

WFF は広範で複雑なトピックとで詳細情報を入手することができます、 [IIS 7 用の Microsoft Web Farm Framework 2.0](https://go.microsoft.com/?linkid=9805129) web サイト。 しばらくの間、ただしが意識する必要がある 2 つの機能領域です。

- *アプリケーションのプロビジョニング*はサーバー ファーム内のすべてのセカンダリ サーバー間で web アプリケーションと構成の設定のように、プライマリ サーバーからコンテンツを複製するプロセスです。 たとえば、Contact Manager サンプル ソリューションをプライマリのステージング サーバーに配置する場合 WFF アプリケーションのプロビジョニング プロセスがこのソリューションをすべてのセカンダリ ステージング サーバーにデプロイするされます。 既定では、アプリケーションのプロビジョニング プロセスには、30 秒ごとが実行されます。
- *プラットフォームのプロビジョニング*は web platform 製品と、プライマリ サーバーからサーバー ファーム内のすべてのセカンダリ サーバーに、コンポーネントを同期するプロセスです。 たとえば、プライマリ、ステージング サーバーに ASP.NET MVC 3 をインストールする場合、プラットフォームのプロビジョニング プロセスは、Web Platform Installer すべて、セカンダリ ステージング サーバー上で ASP.NET MVC 3 をインストールする使用します。 既定では、プラットフォームのプロビジョニング プロセスには、5 分が実行されます。

管理できます基本的なアプリケーションとプラットフォームのプロビジョニングの設定から IIS マネージャー、WFF コント ローラーのサーバー上。

**アプリケーションとプラットフォームのプロビジョニングの設定を詳細します。**

1. IIS マネージャーで、**接続**ウィンドウで、サーバー ファームを選択します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image9.png)
2. **サーバー ファーム**ウィンドウで、ダブルクリックして**アプリケーションのプロビジョニング**します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image10.png)
3. ご覧のように、サーバー ファームは 30 秒ごとに、プライマリ サーバーとセカンダリ サーバーの間の web コンテンツと構成設定を同期する構成されています。
4. をクリックして**戻る**、し、ダブルクリック**プラットフォームのプロビジョニング**します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image11.png)
5. ご覧のように、サーバー ファームは 5 分ごとに web プラットフォーム製品とコンポーネント間、プライマリ サーバーとセカンダリ サーバーを同期する構成されています。
6. クリックして**戻る**します。
7. Web プラットフォーム製品をすぐに同期するサーバー ファームを強制的にで、**アクション**ウィンドウで、をクリックして**プラットフォームのプロビジョニング**します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image12.png)

    > [!NOTE]
    > プラットフォームのプロビジョニングと、時間がかかる場合があります。 インストーラー プロセスは、サーバー ファーム内のセカンダリ サーバーでは、バック グラウンドで実行されます。
8. プロビジョニング プロセスが完了するための十分な時間を許可するよう、製品と、プライマリ サーバーに追加したコンポーネントが、セカンダリ サーバーでレプリケートされて今すぐいるを確認できます。 たとえば、セカンダリ サーバーにログオンしを使用して、**サーバー マネージャー**ウィンドウを web サーバーの役割がインストールされていることを確認します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image13.png)
9. さまざまな web プラットフォームのコンポーネントが追加されていることを確認してインストールされているプログラムの一覧を確認することもできます。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image14.png)

## <a name="configure-load-balancing"></a>負荷分散を構成します。

Web ファームを作成するときに、web サーバー間での HTTP 要求を分散する負荷分散の何らかの形式を設定する必要があります。 これは、Windows Server 2008 のネットワーク負荷分散、IIS ARR、またはサード パーティ製ソフトウェア ベースまたはハードウェア ベースの負荷が分散ソリューションです。

IIS の先端と密接に統合する WFF は設計されています この統合を利用するには、WFF コント ローラー サーバーに ARR モジュールをインストールする必要があります。 すべてのトラフィック、web、コント ローラー サーバーに通常ドメイン ネーム システム (DNS) レコードを構成することで。 コント ローラーのサーバーは、サーバーの可用性とさまざまなその他の条件に基づいて、ファーム内のサーバー間で着信要求を分散します。

> [!NOTE]
> WFF; で、ARR を使用する必要はありません。サード パーティの負荷分散ソリューションを使用する WFF を構成することができます。 詳細については、次を参照してください。 [IIS 7 Web Farm Framework 2.0 の概要](https://go.microsoft.com/?linkid=9805126)します。


このチュートリアルの範囲を超えてはこれの最も複雑なトピックでは、ARR を使用して負荷分散します。 ただし、ARR モジュールをインストールし、負荷分散の概要を次の手順を使用することができます。

**WFF コント ローラーのサーバーでの負荷分散を設定するには**

1. WFF コント ローラーのサーバーでは、Web Platform Installer を起動します。
2. 上部にある、 **Web Platform Installer 3.0**ウィンドウで、をクリックして**製品**します。
3. ナビゲーション ウィンドウで、ウィンドウの左側にある クリックして**Server**します。
4. **アプリケーション要求ルーティング 2.5**行で、をクリックして**追加**します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image15.png)
5. クリックして**インストール**、しの指示に従って、 **Web Platform のインストール**ウィンドウ。
6. インストールが完了したら、IIS マネージャーを起動し、**接続**ウィンドウで、サーバー ファームのノードをクリックします。 追加されたいくつかの新しいアイコンに注意してください、**サーバー ファーム**ウィンドウ。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image16.png)
7. **サーバー ファーム**ウィンドウで、ダブルクリックして**負荷分散**します。
8. **負荷分散**アルゴリズムのバランスを取るウィンドウで、ロードを選択します (たとえば、**少なくとも現在の要求**)。

    > [!NOTE]
    > 負荷分散アルゴリズムとその他の構成設定の詳細については、次を参照してください。[アプリケーション要求ルーティング モジュール](https://go.microsoft.com/?linkid=9805130)します。

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image17.png)
9. **アクション**ウィンドウで、をクリックして**適用**します。

基本的な負荷分散、サーバー ファーム内のサーバーが構成されました。 コント ローラー サーバーにすべての web ファーム トラフィックを転送する場合、要求は可用性に応じて、ファーム内のサーバーと選択した負荷分散アルゴリズムの間で配布されます。

ARR で負荷分散を構成する方法の詳細については、次を参照してください。[アプリケーション要求ルーティング モジュール](https://go.microsoft.com/?linkid=9805130)します。

## <a name="monitor-the-server-farm"></a>サーバー ファームを監視します。

コント ローラーのサーバーで IIS マネージャーで、いつでも、サーバー ファームのヘルスを監視できます。 **接続**ウィンドウでは、サーバー ファームを展開して、クリックして**サーバー**します。 中央のウィンドウは、最近のアクティビティのトレース ログと共に、ファーム内の各サーバーの概要を紹介します。

![](creating-a-server-farm-with-the-web-farm-framework/_static/image18.png)

## <a name="conclusion"></a>まとめ

WFF サーバー ファームは稼働しているのようになります。 必要に応じてどの展開方法をサポートするために、プライマリ サーバーを構成する&#x2014;詳細については「関連項目」セクションを参照してください。&#x2014;し、構成は、サーバー ファーム内の各セカンダリ サーバーにレプリケートされます。

## <a name="further-reading"></a>関連項目

構成と使用、WFF のすべての側面の詳細については、次を参照してください。、 [IIS 7 用の Microsoft Web Farm Framework 2.0](https://go.microsoft.com/?linkid=9805129) web サイト。

> [!div class="step-by-step"]
> [前へ](configuring-a-database-server-for-web-deploy-publishing.md)
> [次へ](configuring-deployment-properties-for-a-target-environment.md)
